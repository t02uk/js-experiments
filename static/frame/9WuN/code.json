{"source":{"css":"body { background-color: #000000; margin: 0px; overflow: hidden; ","html":"<div id=\"outer\">\n<canvas id=\"world\"></canvas>\n</div>\n","lisence":"MIT","js":"// forked from t02uk's \"地アナ化\" http://jsdo.it/t02uk/jpBN\n\nwindow.onload = (function() {\n\n  jQuery.noConflict();\n  var $j = jQuery;\n\n  // 動画読み込み\n  var media = $j(\"<video>\")\n    .attr(\"src\", \"http://dl.dropbox.com/u/3589634/resource/movie/Phonogram%20AEmix.mp4\")\n    .attr(\"autoplay\", true)\n    .hide();\n\n  var vw = 480;\n  var vh = 270;\n  var ratio = vh / vw;\n  var canplay = false;\n  media[0].addEventListener(\"canplay\", function(e) {\n    canplay = true;\n  });\n  $j(\"#outer\").append(media);\n  media[0].width = vw;\n  media[0].height = vh;\n\n  // canvas設定\n//  var cw = 300;\n//  var ch = 300 * ratio;\n//  $j(\"#world\")\n//    .attr(\"width\", cw)\n//    .attr(\"height\", ch)\n\n  var d = new DCore();\n\n\n  var TileCapacity = 8;\n  var TileSize = 1 / TileCapacity;\n  function Tile(p) {\n    this.p = p;\n    this.op = p.clone();\n    this.xroll = 0;\n    this.yroll = 0;\n    this.xrollm = 0;\n    this.yrollm = 0;\n    this.idealSize = TileSize;\n    this.size = TileSize;\n    this.sid = Tile.prototype.genSid();\n    this.top = 0;\n  }\n  Tile.prototype = {\n    genSid: function() {\n      if(!Tile.sid) return Tile.sid = 1;\n      else return Tile.sid++;\n    },\n    genTop: function() {\n      if(!Tile.top) return Tile.top = 1;\n      else return Tile.top++;\n    },\n    topTo: function() {\n      this.top = this.genTop();\n    },\n    act: function() {\n      this.xroll += this.xrollm;\n      this.yroll += this.yrollm;\n      if(Math.cos(this.xroll) > 0.95) {\n        this.xrollm *= 0.7;\n      }\n      if(Math.cos(this.yroll) > 0.95) {\n        this.yrollm *= 0.7;\n      }\n    },\n    roll: function(x, y) {\n      this.xrollm += x;\n      this.yrollm += y;\n    },\n    isInBound: function(p) {\n      return this.p[0] - this.size / 2 < p[0] &&\n        p[0] <= this.p[0] + this.size / 2 &&\n        this.p[1] - this.size / 2 < p[1] &&\n        p[1] <= this.p[1] + this.size / 2\n      ;\n    },\n    draw: function() {\n      d.save();\n      d.translate(this.p);\n      d.scale([Math.cos(this.xroll), Math.cos(this.yroll)]);\n      d.scale([this.size, this.size]);\n      var s = this.size;\n\n      d\n        .rgb(0x33, 0x33, 0x33)\n        .drawImage(media[0],\n          this.op.sub([this.idealSize / 2, this.idealSize / 2]),\n          [this.idealSize, this.idealSize],\n          [-0.5, -0.5],\n          [1.0, 1.0]\n        )\n        .quads([\n         [-1,  1],\n         [-1, -1],\n         [ 1, -1],\n         [ 1,  1]\n        ].scale([0.5, 0.5]))\n        .stroke()\n      ;\n\n      d.restore();\n    }\n  };\n\n  var tiles = $R(0, TileCapacity, true).map(function(x) {\n    return $R(0, TileCapacity, true).map(function(y) {\n      return new Tile([(x + 0.5) / TileCapacity, (y + 0.5) / TileCapacity]);\n    });\n  });\n\n\n  // マウスイベント\n  var px, py, opx, opy, dx, dy, lbdown, dblclick, dblcount;\n  window.addEventListener(\"mousemove\", function(e) {\n    px = e.clientX / d.width - d.left2d;\n    py = e.clientY / d.height - d.top2d;\n    if(opx) {\n      dx = opx - px;\n      dy = opy - py;\n    }\n    opx = px;\n    opy = py;\n  }, false);\n  window.addEventListener(\"mousedown\", function(e) {\n    lbdown = true;\n  }, false);\n  window.addEventListener(\"mouseup\", function(e) {\n    lbdown = false;\n  }, false);\n  window.addEventListener(\"dblclick\", function(e) {\n    dblclick = true;\n  }, false);\n\n  var c = 0;\n\n\n  window.setInterval(function() {\n    c++;\n\n    // on loading\n    if(!canplay) {\n      d\n       .rgb(0xff, 0xff, 0xff)\n       .fillBack()\n       .fill()\n      ;\n\n      d\n       .font('monospace', 0.10, 'bold')\n       .textAlign(\"left\")\n       .rgb(0x9f, 0x9f, 0x9f)\n       .alpha(1)\n       .blend(\"copy\")\n       .fillText(\"／｜＼―\".charAt((c / 4) % 4) + \" now loading\", [0.1, 0.45])\n       .fill()\n      ;\n      return;\n    }\n    // v else\n\n\n    d\n      .rgb(0x00, 0x00, 0x00)\n      .fillBack()\n      .fill()\n    ;\n\n\n    if(px) {\n\n      // ポジションリセット\n      if(dblcount >= 0) {\n        tiles.flatten().each(function(tile) {\n          tile.p[0] = (tile.op[0] + tile.p[0]) / 2;\n          tile.p[1] = (tile.op[1] + tile.p[1]) / 2;\n          tile.xroll /= 2;\n          tile.yroll /= 2;\n          tile.xrollm /= 2;\n          tile.yrollm /= 2;\n        });\n      }\n\n      // くるくる\n      if(!lbdown) {\n\n        // [0] -> active, [1], unactive\n        var partitioned = tiles.flatten().partition(function(tile) {\n          return tile.isInBound([px, py]);\n        });\n\n        partitioned[0].each(function(tile) {\n          // unactive -> active\n          if(!tile.active) {\n            tile.roll(dx * 10, dy * 10);\n          }\n          tile.active = true;\n        });\n\n        partitioned[1].each(function(tile) {\n          tile.active = false;\n        });\n      } else {\n      // ドラッグドゥ\n        tiles.flatten().select(function(tile) {\n          return tile.active;\n        }).each(function(tile) {\n          tile.topTo();\n          tile.p = tile.p.add([px, py]).mul(1 / 2);\n        });\n      }\n    }\n\n    // タイル動き\n    tiles.flatten().sortBy(function(e){return e.top;}).map(function(tile) {\n      tile.act();\n      tile.draw();\n    });\n\n    // ダブルクリック制御\n    if(dblclick) {\n      dblcount = 10;\n    }\n    dblclick = false;\n    dblcount--;\n\n  }, 33);\n});\n\n"},"thumbnail":{"wide":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/9/W/u/9WuN_w.jpg","465":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/9/W/u/9WuN.jpg","100":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/9/W/u/9WuN_100.jpg"},"description_html":"動画インタラクティブアートリベンジ。タイル動画。<br />\n触る意味のあるインタフェースを作れる気ががが。<br />\n・ドラッグ、ダブルクリック、で何か。<br />\n※Chrome9.0で確認。<br />\n<br />\n元動画(yama-koさんのPhonogram AEmix)はこっち。<br />\n<a  href=\"http://www.youtube.com/watch?v=SBb4N8GYidw\">http://www.youtube.com/watch?v=SBb4N8GYidw</a>","parent":{"thumbnail":{"wide":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/j/p/B/jpBN_w.jpg","465":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/j/p/B/jpBN.jpg","100":"http://jsdo-static-contents.s3.amazonaws.com/images/capture/j/p/B/jpBN_100.jpg"},"modified_date":"2011-01-22 21:09:07","uid":"jpBN","created_date":"2011-01-22 18:51:58","path":"jpBN","description":"デジタル放送→アナログ放送変換フィルタ。\n・HTML5で追加されたVideo要素の電波受信状況を悪くする。\n・マウスカーソルが出すノイズを強化する。\n※Chromeだけで動作確認\n\n元の動画(【初音ミク】WhiteLetter【アニメＰＶ完成版】)はこっち。\nニコニコ動画：http://www.nicovideo.jp/watch/sm1379990\nyoutube: http://www.youtube.com/watch?v=_MZeV3Q5mCc","statistic":{"forked":"2","favorite":"2","pageview":"2710"},"user":{"icon":"http://jsdo-static-contents.s3.amazonaws.com/images/icon/b/4/2/c/b42cc3dd3312505b680411b3ead08e2dbc4192e4_100.jpg","name":"crispy"},"url":"http://jsdo.it/crispy/jpBN","title":"地アナ化"},"modified_date":"2011-01-23 21:34:17","uid":"9WuN","created_date":"2011-01-23 20:25:02","path":"9WuN","description":"動画インタラクティブアートリベンジ。タイル動画。\n触る意味のあるインタフェースを作れる気ががが。\n・ドラッグ、ダブルクリック、で何か。\n※Chrome9.0で確認。\n\n元動画(yama-koさんのPhonogram AEmix)はこっち。\nhttp://www.youtube.com/watch?v=SBb4N8GYidw","statistic":{"forked":"0","favorite":"2","pageview":"1932"},"url":"http://jsdo.it/crispy/9WuN","user":{"icon":"http://jsdo-static-contents.s3.amazonaws.com/images/icon/b/4/2/c/b42cc3dd3312505b680411b3ead08e2dbc4192e4_100.jpg","name":"crispy"},"title":"tiled video"}